---
- name: Conf dirs
  file:
    dest: "{{ user_home }}/.config/{{ item }}"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"
  with_items:
    - nvim
    - alacritty
    - rofi

- name: Link dots
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/{{ item }}"
    dest: "{{ user_home }}/.{{ item }}"
    owner: "{{ user }}"
    group: "{{ user }}"
  with_items:
    - zshrc
    - bashrc
    - bash_aliases
    - exports.common
    - vimrc
    - screenrc
    - tmux.conf
    - gitconfig

- name: Link bins
  become: yes
  file:
    state: link
    force: no
    src: "{{ item }}"
    dest: "/usr/local/bin/{{ item | basename }}"
  with_fileglob:
    - "{{ role_path }}/files/bin/*"

- name: Link config others
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/{{ item }}"
    dest: "{{ user_home }}/.config/{{ item }}"
    owner: "{{ user }}"
    group: "{{ user }}"
  with_items:
    - starship.toml

- name: Link nvim
  file:
    state: link
    src: "{{ user_home }}/.vimrc"
    dest: "{{ user_home }}/.config/nvim/init.vim"
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Link alacritty
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/alacritty.yml"
    dest: "{{ user_home }}/.config/alacritty/alacritty.yml"
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Link alacritty dark
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/alacritty-dark.yml"
    dest: "{{ user_home }}/.config/alacritty/alacritty-dark.yml"
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Link rofi config
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/roficonfig"
    dest: "{{ user_home }}/.config/rofi/config"
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Src dir
  file:
    path: "{{ user_home }}/src"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Bin dir
  become: yes
  file:
    path: "{{ user_home }}/bin"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"

- name: vim tmp
  file:
    path: "{{ user_home }}/.vim-tmp"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"

# Replicate Plug setup for nvim
# https://github.com/junegunn/vim-plug
#
# curl -fLo ~/.local/share/nvim/site/autoload/plug.vim --create-dirs \
#   https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
- name: nvim autoload dir
  file:
    path: "{{ user_home }}/.local/share/nvim/site/autoload"
    state: directory
    owner: "{{ user }}"
    group: "{{ user }}"

- name: nvim plug dl
  get_url:
    url: 'https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim'
    dest: "{{ user_home }}/.local/share/nvim/site/autoload/plug.vim"
    mode: "0755"


# bash utils for git completion
- name: git prompt
  get_url:
    url: https://raw.githubusercontent.com/git/git/master/contrib/completion/git-prompt.sh
    dest: "{{ user_home }}/.git-prompt.sh"
    mode: "0755"

- name: git completion
  get_url:
    url: https://raw.githubusercontent.com/git/git/master/contrib/completion/git-completion.bash
    dest: "{{ user_home }}/.git-completion.sh"
    mode: "0755"

- name: hexchat config
  file:
    state: directory
    dest: "{{ user_home }}/.config/hexchat"
    owner: "{{ user }}"
    group: "{{ user }}"

- name: Link hexchat dots
  file:
    state: link
    force: yes
    src: "{{ role_path }}/files/hexchat/{{ item }}"
    dest: "{{ user_home }}/.config/hexchat/{{ item }}"
    owner: "{{ user }}"
    group: "{{ user }}"
  with_items:
    - hexchat.conf
    - colors.conf
